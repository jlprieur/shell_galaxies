C++-------------------------------------------------------------------------
C CALCUL DE LA PRECESSION
C From Mireille Cailloux
C---------------------------------------------------------------------------
	PROGRAM PRECESSION
 
	PRINT *,'        VALEURS FOURNIES PAR LE CATALOGUE:'
	PRINT *,' 1) ANNEE:'
	READ(5,*) T0
	PRINT *,' 2) ASCENSION DROITE DONNEE EN: HEURE,MINUTE,SECONDE'
	READ(5,*) ADH,ADM,ADS
	PRINT *,' 2) DECLINAISON DONNEE EN: DEGRE,MINUTE,SECONDE'
	READ(5,*) DD,DM,DS
	PRINT *,' ANNEE QUI NOUS INTERESSE:'
	READ(5,*) T1
	T=(T1+T0)/2.-1900.
	T=T/1000.
	DT=T1-T0
	RD=3.14159/180.
	VM=46.08506+0.27945*T+0.00012*T*T
C VMS : EN SECONDE D"HEURE
	VMS=VM/15.
	VN=20.04685-0.08533*T-0.00037*T*T
	VNS=VN/15.
C VN: EN SECONDE , VNS: EN SECONDE D"HEURE
	ALPHA0=(ADH*3600.+ADM*60.+ADS)
	ALPHA=ALPHA0*15./3600.
C ALPHA EN DEGRES
	COSA=COS(ALPHA*RD)
	SINA=SIN(ALPHA*RD)
	DELTA0=ABS(DD)*3600.+DM*60.+DS
	IF (DD.LT.0.) DELTA0=-DELTA0
	DELTA=DELTA0/3600.
	TAND=TAN(DELTA*RD)
	ALPHA1=ALPHA0+VMS*DT+VNS*DT*SINA*TAND
	DELTA1=DELTA0+VN*DT*COSA
	IDD=INT(DELTA1/3600.)
	B=DELTA1-IDD*3600.
	B=ABS(B)
	IDM=INT(B/60.)
	B1=B-IDM*60.
	PRINT 200
200	FORMAT(/)
	PRINT *,' DECLINAISON:',IDD,' DEGRES',IDM,' MN',B1,'SEC'
	IAH=INT(ALPHA1/3600.)
	C=ALPHA1-IAH*3600.
	IAM=INT(C/60.)
	C1=C-IAM*60.
	PRINT 200
	PRINT *,' ASCENSION DROITE:',IAH,'H',IAM,' MN',C1,'SEC'
	PRINT 200
	STOP
	END
